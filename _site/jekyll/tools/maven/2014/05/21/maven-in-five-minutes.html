<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Apache Maven 快速预览</title>
    <meta name="viewport" content="width=device-width">

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

    <!-- tags css -->
    <link rel="stylesheet" href="/css/tag_cloud.css">

</head>
<body>

<div class="site">
    <div class="header">
        <h1 class="title"><a href="/">Blog Everything</a></h1>
        <a class="extra" href="/">主页</a>
    </div>

    <h2>Apache Maven 快速预览</h2>
<p class="meta">21 May 2014</p>

<div class="post">
    <h3>安装</h3>

<p>maven 是一个 java 工具，所以必须先安装 java．</p>

<ol>
<li>下载，<a href="http://maven.apache.org/download.html">apache maven download</a></li>
<li>安装，参照 <a href="http://maven.apache.org/download.html#Installation">maven install installation</a></li>
</ol>

<p>安装完成后输入：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn --version
</code></pre></div>
<p>输出当前的 maven 信息，例如：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Apache Maven 3.1.1 (NON-CANONICAL_2013-11-08_14-32_mockbuild; 2013-11-08 22:32:41+0800)
Maven home: /usr/share/maven
Java version: 1.7.0_55, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.60-2.4.7.0.fc20.x86_64/jre
Default locale: zh_CN, platform encoding: UTF-8
OS name: &quot;linux&quot;, version: &quot;3.14.3-200.fc20.x86_64&quot;, arch: &quot;amd64&quot;, family: &quot;unix&quot;
</code></pre></div>
<h3>创建工程</h3>

<p>在终端执行下面的命令：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn archetype:generate -DgroupId=com.mycompany.app -DartifactId=my-app \
                       -DarchetypeArtifactId=maven-archetype-quickstart \
                       -DinteractiveMode=false
</code></pre></div>
<p>如果是第一次安装 maven，会需要等待一段时间，是因为要下载一些常用的资源（插件和常用的库，放在 ~/.m2/）．执行完成后，
会创建一个工程目录，名称就是输入的 <code>my-app</code>．进入目录：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">cd my-app
</code></pre></div>
<p>工程的目录结构如下：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">my-app
|-- pom.xml
`-- src
    |-- main
    |   `-- java
    |       `-- com
    |           `-- mycompany
    |               `-- app
    |                   `-- App.java
    `-- test
        `-- java
            `-- com
                `-- mycompany
                    `-- app
                        `-- AppTest.java
</code></pre></div>
<p><code>src/main/java/</code> 目录包含工程源码，<code>src/test/java/</code> 包含工程测试代码，<code>pom.xml</code> 就是工程的 <em>工程对象模型</em>，
简称 POM．</p>

<h4>POM</h4>

<p>POM 文件在 maven 中是一种核心的配置文件，包含了大量构建工程的信息．这个文件可能非常巨大而复杂，不过即使不用了解它的
全部也能顺利的使用 maven．初始的 POM 文件内容是：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;com.mycompany.app&lt;/groupId&gt;
  &lt;artifactId&gt;my-app&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;

  &lt;name&gt;Maven Quick Start Archetype&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;4.8.2&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h4>工程如何产生的？</h4>

<p>之所以会生成工程目录，是因为使用了 <em>archetype:generate</em>，前缀 <em>archetype</em> 是 <em>plugin</em>， <em>generate</em> 是
<em>goal</em>．这很类似 Ant 的任务，或者 Rake 的任务．这个方法根据 <em>archetype</em> 创建了一个简单的工程．基本上，一个插件包含一系列
的 goal，用于处理特定的一组问题，比如插件 <em>jboss-maven-plugin</em> 就是用来处理各种与 jboss 相关的问题的．</p>

<h4>构建工程</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn package
</code></pre></div>
<p>输出信息：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> ...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 2 seconds
[INFO] Finished at: Thu Jul 07 21:34:52 CEST 2011
[INFO] Final Memory: 3M/6M
[INFO] ------------------------------------------------------------------------
</code></pre></div>
<p>和前面的 <code>archetype:generate</code> 不同，这不是一个 <em>goal</em>，而是一个 <em>phase</em>，是 <em>build lifecycle</em> 中的一步．
<em>build livecycle</em> 是系列有序的 <em>phase</em>，当执行其中一个 <em>phase</em> 时，这个 <em>phase</em> 前面的也会被依次执行．比如执行
<em>compile phase</em>，实际上依次执行的是：</p>

<ol>
<li>validate</li>
<li>generate-sources</li>
<li>process-sources</li>
<li>generate-resources</li>
<li>process-resources</li>
<li>compile</li>
</ol>

<p>可以测试刚才构建出的结果：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">java -cp target/my-app-1.0-SNAPSHOT.jar com.mycompany.app.App
</code></pre></div>
<p>输出：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Hello World!
</code></pre></div>
<h3>使用 maven 工具</h3>

<h4>maven phases</h4>

<p>列举一些常用的 <em>lifecycle phase</em>：</p>

<ul>
<li><code>validate</code> : 验证工程是否正确，需要的信息是否存在</li>
<li><code>compile</code>  : 编译工程的源码</li>
<li><code>test</code>     : 执行测试</li>
<li><code>package</code>  : 打包，比如打包成 JAR 文件</li>
<li><code>integration-test</code>  : 将构建出的包文件发布到集成开发环境测试</li>
<li><code>verity</code>   : 验证包是否如何规范</li>
<li><code>install</code>  : 将包安装到本地仓库（~/.m2/repository），可以被其他工程使用</li>
<li><code>deploy</code>   : 发布到集成测试环境或者互联网，可以被其他的开发者使用</li>
</ul>

<p>还有两个 <em>phase</em>：</p>

<ul>
<li><code>clean</code>    : 清理构建过程产生的文件</li>
<li><code>site</code>     : 生成文档</li>
</ul>

<p>其实在 <em>phase</em> 的底层还是调用其他的 <em>goal</em>，例如 <em>package phase</em> 被执行时，如果工程类型是 jar，则执行 <em>jar:jar</em>，
如果是 war，则执行 <em>war:war</em></p>

<p><em>goal</em> 和 <em>phase</em> 可以顺序执行：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn clean dependency:copy-dependencies package
</code></pre></div>
<h4>生成文档</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn site
</code></pre></div>
<p>会根据工程的 pom.xml 中的信息生成 html 文档，以及各种报告，生成的结果在 target/site 下．</p>

<h3>结论</h3>

<p>这只是一些最基本的介绍，更详细的介绍参见 <a href="mvn%20clean%20dependency:copy-dependencies%20package">maven getting started guide</a></p>


    
    <h3>标签 : </h3>
    <p class="tags">
        
        <a href="/tags/Tool/">Tool</a>
        
        <a href="/tags/Maven/">Maven</a>
        
    </p>
    

    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'lyfblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>


    <div class="footer">
        <div class="contact">
            <p>
                YifengLiu<br/>
                software engineer<br/>
            </p>
        </div>
        <div class="contact">
            <p>
                <a href="https://github.com/lyfshadyboss">github.com/lyfshadyboss</a><br/>
                <a href="https://twitter.com/lyfshadyboss">twitter.com/lyfshadyboss</a><br/>
            </p>
        </div>
    </div>
</div>

</body>
</html>
